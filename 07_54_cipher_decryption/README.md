# Cryptanalysis

This is a cryptanalysis project that aims to decrypt a document which was encrypted by substituting the original
characters with others, without knowing the substitution rule. The project employs a Genetic Algorithm approach to find
the best solution.

The program assumes that the document was written in English and the encryption is done using a simple character
substitution cipher, which replaces every instance of a certain character with a different character.

## Requirements

* Python 3.6+
* Numpy

## How It Works

The project uses a Genetic Algorithm to iteratively improve a set of candidate solutions. In this case, each solution is
a possible character substitution cipher (mapping). The algorithm works as follows:

1. **Initialization**: A set of random mappings is generated.
2. **Scoring**: Each mapping's quality (fitness) is evaluated by using it to decrypt the document and comparing the
   resulting text to expected English language patterns.
3. **Selection**: A set of the best-scoring mappings is selected.
4. **Mutation**: New mappings are generated by making small random changes (swapping two characters) to the selected
   mappings.
5. **Looping**: Steps 2-4 are repeated for a specified number of iterations (epochs), or until the score stops
   improving.

The quality of a mapping is evaluated based on a bigram model of English, i.e., the frequency of pairs of consecutive
characters in English words. The bigram model is learned from a reference text (`data/moby_dick.txt`).

## Setup & Usage

1. Clone the repository and navigate to the project directory. The repository already includes a dataset in the folder
   `data` to build the English vocabulary based from the novel Moby Dick: `data/moby_dick.txt`.
2. There's also another text to encrypt `data/sample_text.txt`. If you want to test your own text to encrypt,
   create a file like `sample_text.txt` with your text and run the script.
3. Install the requirements:

    ```commandline
    pip install numpy
    ```

3. Run the script:

    ```commandline
    python main.py
    ```

## Code Structure

The project includes the following main functions:

- `load_document`: Loads the document to be decrypted, removing whitespace and punctuation, and converting to lowercase.
- `create_random_mappings`: Generates a list of random character mappings.
- `crypt_decrypt_message`: Encrypts or decrypts a text message based on a given mapping.
- `swap_mapping`: Mutates a mapping by swapping two characters.
- `calculate_score`: Evaluates the quality (fitness) of a set of mappings.
- `compare_mappings`: Compares two mappings and returns their similarity.

## Results

The program prints out the best mapping found, the decrypted text, and the accuracy of the mapping.
For example:

```text
Results:
{'a': 'i', 'b': 'o', 'c': 'j', 'd': 'n', 'e': 'a', 'f': 'm', 'g': 'r', 'h': 'z', 'i': 'c', 'j': 'l', 'k': 'd', 'l': 'w', 'm': 'h', 'n': 'x', 'o': 's', 'p': 'b', 'q': 'v', 'r': 'f', 's': 'q', 't': 'k', 'u': 'e', 'v': 'u', 'w': 'y', 'x': 't', 'y': 'p', 'z': 'g'}
i then lounged down the street and yound, as i expected, that there was a mews in a lane which runs down bf one wall oy the garden. i lent the ostlers a hand in rubbing down their horses, and received in exchange twopence, a glass oy haly-and-haly, two yills oy shag tobacco, and as much inyormation as i could desire about miss adler, to saf nothing oy haly a doken other people in the neighbourhood in whom i was not in the least interested, but whose biographies i was compelled to listen to.
The accuracy is: 92.31%
```

## Potential improvements

While the program is currently capable of deciphering texts encrypted with simple substitution ciphers, future updates
could include handling more complex types of encryption. Possible enhancements include supporting multi-letter ciphers,
handling punctuation and uppercase letters, and parallelizing the genetic algorithm for faster performance.

## Inspiration

This project was built when following a lesson from [The Lazy Programmer](https://github.com/lazyprogrammer), from the
course Machine Learning: Natural Language Processing in Python (V2).

## License

This project is licensed under the terms of the [MIT](https://choosealicense.com/licenses/mit/) license.
